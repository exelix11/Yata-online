Bridge.assembly("YataOnline",function(){"use strict";Bridge.define("PuyoTools.Modules.IModule",{$kind:"interface"});Bridge.define("PuyoTools.Modules.Compression.LzBufferDictionary",{fields:{MinMatchAmount:0,MaxMatchAmount:0,BufferSize:0,BufferStart:0,BufferPointer:0,BufferData:null,OffsetList:null},ctors:{init:function(){this.MinMatchAmount=3;this.MaxMatchAmount=18;this.BufferSize=0;this.BufferStart=0;this.BufferPointer=0},ctor:function(){this.$initialize();this.OffsetList=System.Array.init(256,null,System.Collections.Generic.List$1(System.Int32));for(var i=0;i<this.OffsetList.length;i=i+1|0)this.OffsetList[System.Array.index(i,this.OffsetList)]=new(System.Collections.Generic.List$1(System.Int32).ctor);this.BufferData=System.Array.init(0,0,System.Byte)}},methods:{Search:function(DecompressedData,offset,length){var Match,MatchStart,MatchSize,BufferPos,i;if(this.RemoveOldEntries(DecompressedData[System.Array.index(offset,DecompressedData)]),System.Int64(offset).lt(System.Int64(this.MinMatchAmount))||System.Int64(length-offset).lt(System.Int64(this.MinMatchAmount)))return System.Array.init([0,0],System.Int32);for(Match=System.Array.init([0,0],System.Int32),i=this.OffsetList[System.Array.index(DecompressedData[System.Array.index(offset,DecompressedData)],this.OffsetList)].Count-1|0;i>=0;i=i-1|0){for(MatchStart=this.OffsetList[System.Array.index(DecompressedData[System.Array.index(offset,DecompressedData)],this.OffsetList)].getItem(i),BufferPos=(this.BufferStart+MatchStart|0)&(this.BufferSize-1|0),MatchSize=1;MatchSize<this.MaxMatchAmount&&MatchSize<this.BufferSize&&System.Int64(MatchStart+MatchSize).lt(System.Int64(offset))&&System.Int64(offset).add(System.Int64(MatchSize)).lt(System.Int64(length))&&DecompressedData[System.Array.index(System.Int64.toNumber(System.Int64(offset).add(System.Int64(MatchSize))),DecompressedData)]===this.BufferData[System.Array.index((BufferPos+MatchSize|0)&(this.BufferSize-1|0),this.BufferData)];)MatchSize=MatchSize+1|0;if(MatchSize>=this.MinMatchAmount&&MatchSize>Match[System.Array.index(1,Match)]&&(Match=System.Array.init([BufferPos,MatchSize],System.Int32),MatchSize===this.MaxMatchAmount))break}return Match},RemoveOldEntries:function(index){for(var i=0;i<this.OffsetList[System.Array.index(index,this.OffsetList)].Count;)if(this.OffsetList[System.Array.index(index,this.OffsetList)].getItem(i)>=(this.BufferPointer-this.BufferSize|0))break;else this.OffsetList[System.Array.index(index,this.OffsetList)].removeAt(0)},SetBufferSize:function(size){if(this.BufferSize!==size){this.BufferSize=size;this.BufferData=System.Array.init(this.BufferSize,0,System.Byte);for(var i=0;i<this.BufferSize;i=i+1|0)this.BufferData[System.Array.index(i,this.BufferData)]=0,this.OffsetList[System.Array.index(0,this.OffsetList)].add(i-this.BufferSize|0)}},SetBufferStart:function(pos){this.BufferStart=pos},SetMinMatchAmount:function(amount){this.MinMatchAmount=amount},SetMaxMatchAmount:function(amount){this.MaxMatchAmount=amount},AddEntry:function(DecompressedData,offset){this.BufferData[System.Array.index((this.BufferStart+this.BufferPointer|0)&(this.BufferSize-1|0),this.BufferData)]=DecompressedData[System.Array.index(offset,DecompressedData)];this.OffsetList[System.Array.index(DecompressedData[System.Array.index(offset,DecompressedData)],this.OffsetList)].add(this.BufferPointer);this.BufferPointer=this.BufferPointer+1|0},AddEntryRange:function(DecompressedData,offset,length){for(var i=0;i<length;i=i+1|0)this.AddEntry(DecompressedData,offset+i|0)}}});Bridge.define("PuyoTools.Modules.Compression.LzWindowDictionary",{fields:{WindowSize:0,WindowStart:0,WindowLength:0,MinMatchAmount:0,MaxMatchAmount:0,BlockSize:0,OffsetList:null},ctors:{init:function(){this.WindowSize=4096;this.WindowStart=0;this.WindowLength=0;this.MinMatchAmount=3;this.MaxMatchAmount=18;this.BlockSize=0},ctor:function(){this.$initialize();this.OffsetList=System.Array.init(256,null,System.Collections.Generic.List$1(System.Int32));for(var i=0;i<this.OffsetList.length;i=i+1|0)this.OffsetList[System.Array.index(i,this.OffsetList)]=new(System.Collections.Generic.List$1(System.Int32).ctor)}},methods:{Search:function(DecompressedData,offset,length){var Match,MatchStart,MatchSize,i;if(this.RemoveOldEntries(DecompressedData[System.Array.index(offset,DecompressedData)]),System.Int64(offset).lt(System.Int64(this.MinMatchAmount))||System.Int64(length-offset).lt(System.Int64(this.MinMatchAmount)))return System.Array.init([0,0],System.Int32);for(Match=System.Array.init([0,0],System.Int32),i=this.OffsetList[System.Array.index(DecompressedData[System.Array.index(offset,DecompressedData)],this.OffsetList)].Count-1|0;i>=0;i=i-1|0){for(MatchStart=this.OffsetList[System.Array.index(DecompressedData[System.Array.index(offset,DecompressedData)],this.OffsetList)].getItem(i),MatchSize=1;MatchSize<this.MaxMatchAmount&&MatchSize<this.WindowLength&&System.Int64(MatchStart+MatchSize).lt(System.Int64(offset))&&System.Int64(offset).add(System.Int64(MatchSize)).lt(System.Int64(length))&&DecompressedData[System.Array.index(System.Int64.toNumber(System.Int64(offset).add(System.Int64(MatchSize))),DecompressedData)]===DecompressedData[System.Array.index(MatchStart+MatchSize|0,DecompressedData)];)MatchSize=MatchSize+1|0;if(MatchSize>=this.MinMatchAmount&&MatchSize>Match[System.Array.index(1,Match)]&&(Match=System.Array.init([System.Int64.clip32(System.Int64(offset).sub(System.Int64(MatchStart))),MatchSize],System.Int32),MatchSize===this.MaxMatchAmount))break}return Match},SlideWindow:function(Amount){this.WindowLength===this.WindowSize?this.WindowStart=this.WindowStart+Amount|0:(this.WindowLength+Amount|0)<=this.WindowSize?this.WindowLength=this.WindowLength+Amount|0:(Amount=Amount-(this.WindowSize-this.WindowLength|0)|0,this.WindowLength=this.WindowSize,this.WindowStart=this.WindowStart+Amount|0)},SlideBlock:function(){this.WindowStart=this.WindowStart+this.BlockSize|0},RemoveOldEntries:function(index){for(var i=0;i<this.OffsetList[System.Array.index(index,this.OffsetList)].Count;)if(this.OffsetList[System.Array.index(index,this.OffsetList)].getItem(i)>=this.WindowStart)break;else this.OffsetList[System.Array.index(index,this.OffsetList)].removeAt(0)},SetWindowSize:function(size){this.WindowSize=size},SetMinMatchAmount:function(amount){this.MinMatchAmount=amount},SetMaxMatchAmount:function(amount){this.MaxMatchAmount=amount},SetBlockSize:function(size){this.BlockSize=size;this.WindowLength=size},AddEntry:function(DecompressedData,offset){this.OffsetList[System.Array.index(DecompressedData[System.Array.index(offset,DecompressedData)],this.OffsetList)].add(offset)},AddEntryRange:function(DecompressedData,offset,length){for(var i=0;i<length;i=i+1|0)this.AddEntry(DecompressedData,offset+i|0)}}});Bridge.define("PuyoTools.Modules.PTMethods",{statics:{methods:{ArraysEqual:function(T,a1,a2){var comparer,i;if(Bridge.referenceEquals(a1,a2))return!0;if(a1==null||a2==null||a1.length!==a2.length)return!1;for(comparer=System.Collections.Generic.EqualityComparer$1(T).def,i=0;i<a1.length;i=i+1|0)if(!comparer.equals2(a1[System.Array.index(i,a1)],a2[System.Array.index(i,a2)]))return!1;return!0},Contains:function(T,source,sourceIndex,compareTo){var comparer,i;if(source==null||compareTo==null||sourceIndex<0||(sourceIndex+compareTo.length|0)>source.length)return!1;for(comparer=System.Collections.Generic.EqualityComparer$1(T).def,i=0;i<compareTo.length;i=i+1|0)if(!comparer.equals2(source[System.Array.index(sourceIndex+i|0,source)],compareTo[System.Array.index(i,compareTo)]))return!1;return!0},RoundUp:function(value,roundUpTo){return value%roundUpTo==0?value:value+(roundUpTo-value%roundUpTo|0)|0},ToUInt16BE:function(value,startIndex){return(value[System.Array.index(startIndex,value)]<<8|value[System.Array.index(startIndex+1|0,value)])&65535},ToUInt32BE:function(value,startIndex){return(value[System.Array.index(startIndex,value)]<<24|value[System.Array.index(startIndex+1|0,value)]<<16|value[System.Array.index(startIndex+2|0,value)]<<8|value[System.Array.index(startIndex+3|0,value)])>>>0},ToInt16BE:function(value,startIndex){return Bridge.Int.sxs((value[System.Array.index(startIndex,value)]<<8|value[System.Array.index(startIndex+1|0,value)])&65535)},ToInt32BE:function(value,startIndex){return value[System.Array.index(startIndex,value)]<<24|value[System.Array.index(startIndex+1|0,value)]<<16|value[System.Array.index(startIndex+2|0,value)]<<8|value[System.Array.index(startIndex+3|0,value)]}}}});Bridge.define("PuyoTools.Modules.PTStream",{statics:{methods:{ReadByte:function(source){var value=source.ReadByte();if(value===-1)throw new System.IO.EndOfStreamException.ctor;return value&255},WriteByteRepeated:function(destination,value,amount){for(var i=0;i<amount;i=i+1|0)destination.WriteByte(value)},CopyTo:function(source,destination){PuyoTools.Modules.PTStream.CopyTo$1(source,destination,4096)},CopyTo$1:function(source,destination,bufferSize){for(var num,buffer=System.Array.init(bufferSize,0,System.Byte);(num=source.Read(buffer,0,buffer.length))!==0;)destination.Write(buffer,0,num)},CopyToPadded:function(source,destination,blockSize,paddingByte){PuyoTools.Modules.PTStream.CopyPartToPadded$1(source,destination,System.Int64.clip32(source.Length.sub(source.Position)),blockSize,paddingByte)},CopyPartTo:function(source,destination,length){PuyoTools.Modules.PTStream.CopyPartTo$1(source,destination,length,4096)},CopyPartTo$1:function(source,destination,length,bufferSize){var num,buffer=System.Array.init(bufferSize,0,System.Byte),amountToRead,copyLength;for(source.Position.add(System.Int64(length)).gt(source.Length)&&(length=System.Int64.clip32(source.Length.sub(source.Position))),amountToRead=length,copyLength=bufferSize,copyLength>amountToRead&&(copyLength=amountToRead);(num=source.Read(buffer,0,copyLength))!==0;)destination.Write(buffer,0,num),amountToRead=amountToRead-num|0,copyLength>amountToRead&&(copyLength=amountToRead)},CopyPartToPadded:function(source,destination,length,blockSize){PuyoTools.Modules.PTStream.CopyPartToPadded$1(source,destination,length,blockSize,0)},CopyPartToPadded$1:function(source,destination,length,blockSize,paddingByte){for(PuyoTools.Modules.PTStream.CopyPartTo(source,destination,length);length%blockSize!=0;)destination.WriteByte(paddingByte),length=length+1|0},Contains:function(source,offset,a){var oldPosition,buffer;return a==null||a.length===0?!1:(oldPosition=source.Position,source.Position=source.Position.add(offset),buffer=System.Array.init(a.length,0,System.Byte),source.Read(buffer,0,a.length),source.Position=oldPosition,PuyoTools.Modules.PTMethods.ArraysEqual(System.Byte,buffer,a))},ReadInt16:function(source){return Bridge.Int.sxs((PuyoTools.Modules.PTStream.ReadByte(source)|PuyoTools.Modules.PTStream.ReadByte(source)<<8)&65535)},ReadInt16BE:function(source){return Bridge.Int.sxs((PuyoTools.Modules.PTStream.ReadByte(source)<<8|PuyoTools.Modules.PTStream.ReadByte(source))&65535)},ReadUInt16:function(source){return(PuyoTools.Modules.PTStream.ReadByte(source)|PuyoTools.Modules.PTStream.ReadByte(source)<<8)&65535},ReadUInt16BE:function(source){return(PuyoTools.Modules.PTStream.ReadByte(source)<<8|PuyoTools.Modules.PTStream.ReadByte(source))&65535},ReadInt32:function(source){return PuyoTools.Modules.PTStream.ReadByte(source)|PuyoTools.Modules.PTStream.ReadByte(source)<<8|PuyoTools.Modules.PTStream.ReadByte(source)<<16|PuyoTools.Modules.PTStream.ReadByte(source)<<24},ReadInt32BE:function(source){return PuyoTools.Modules.PTStream.ReadByte(source)<<24|PuyoTools.Modules.PTStream.ReadByte(source)<<16|PuyoTools.Modules.PTStream.ReadByte(source)<<8|PuyoTools.Modules.PTStream.ReadByte(source)},ReadUInt32:function(source){return(PuyoTools.Modules.PTStream.ReadByte(source)|PuyoTools.Modules.PTStream.ReadByte(source)<<8|PuyoTools.Modules.PTStream.ReadByte(source)<<16|PuyoTools.Modules.PTStream.ReadByte(source)<<24)>>>0},ReadUInt32BE:function(source){return(PuyoTools.Modules.PTStream.ReadByte(source)<<24|PuyoTools.Modules.PTStream.ReadByte(source)<<16|PuyoTools.Modules.PTStream.ReadByte(source)<<8|PuyoTools.Modules.PTStream.ReadByte(source))>>>0},WriteInt16:function(destination,value){destination.WriteByte(value&255);destination.WriteByte(value>>8&255)},WriteInt32:function(destination,value){destination.WriteByte(value&255);destination.WriteByte(value>>8&255);destination.WriteByte(value>>16&255);destination.WriteByte(value>>24&255)},WriteInt32BE:function(destination,value){destination.WriteByte(value>>24&255);destination.WriteByte(value>>16&255);destination.WriteByte(value>>8&255);destination.WriteByte(value&255)},WriteUInt16:function(destination,value){destination.WriteByte(value&255);destination.WriteByte(value>>8&255)},WriteUInt16BE:function(destination,value){destination.WriteByte(value>>8&255);destination.WriteByte(value&255)},WriteUInt32:function(destination,value){destination.WriteByte((value&255)>>>0&255);destination.WriteByte((value>>>8&255)>>>0&255);destination.WriteByte((value>>>16&255)>>>0&255);destination.WriteByte((value>>>24&255)>>>0&255)},WriteUInt32BE:function(destination,value){destination.WriteByte((value>>>24&255)>>>0&255);destination.WriteByte((value>>>16&255)>>>0&255);destination.WriteByte((value>>>8&255)>>>0&255);destination.WriteByte((value&255)>>>0&255)},ReadInt32At:function(source,offset){var oldPosition=source.Position,value;return source.Position=offset,value=PuyoTools.Modules.PTStream.ReadInt32(source),source.Position=oldPosition,value},ReadInt32BEAt:function(source,offset){var oldPosition=source.Position,value;return source.Position=offset,value=PuyoTools.Modules.PTStream.ReadInt32BE(source),source.Position=oldPosition,value},ReadUInt32At:function(source,offset){var oldPosition=source.Position,value;return source.Position=offset,value=PuyoTools.Modules.PTStream.ReadUInt32(source),source.Position=oldPosition,value},ReadCString:function(source){for(var buffer=new(System.Collections.Generic.List$1(System.Byte).ctor),value;(value=PuyoTools.Modules.PTStream.ReadByte(source))!==0;)buffer.add(value);return System.Text.Encoding.ASCII.GetString(buffer.toArray())},ReadCString$1:function(source,length){return PuyoTools.Modules.PTStream.ReadCString$2(source,length,System.Text.Encoding.ASCII)},ReadCString$2:function(source,length,encoding){var buffer=System.Array.init(length,0,System.Byte),index;return source.Read(buffer,0,length),index=System.Array.indexOfT(buffer,0),index===-1&&(index=length),encoding.GetString$1(buffer,0,index)},WriteCString:function(source,str,length){PuyoTools.Modules.PTStream.WriteCString$1(source,str,length,System.Text.Encoding.ASCII)},WriteCString$1:function(source,str,length,encoding){var buffer=encoding.GetBytes$2(str),bytesToWrite=buffer.length,i;for(bytesToWrite>=length&&(bytesToWrite=length-1|0),i=0;i<bytesToWrite;i=i+1|0)source.WriteByte(buffer[System.Array.index(i,buffer)]);for(;i<length;i=i+1|0)source.WriteByte(0)}}}});Bridge.define("PuyoTools.Modules.StreamView",{inherits:[System.IO.Stream],fields:{baseStream:null,streamStart:System.Int64(0),streamLength:System.Int64(0),disposed:!1},props:{CanRead:{get:function(){return this.baseStream.CanRead}},CanSeek:{get:function(){return this.baseStream.CanSeek}},CanWrite:{get:function(){return!1}},Length:{get:function(){return this.streamLength}},Position:{get:function(){return this.baseStream.Position.sub(this.streamStart)},set:function(value){if(value.lt(System.Int64(0))||value.gt(this.streamLength))throw new System.ArgumentException("offset");this.baseStream.Position=this.streamStart.add(value)}}},ctors:{init:function(){this.disposed=!1},ctor:function(source){PuyoTools.Modules.StreamView.$ctor1.call(this,source,source.Length.sub(source.Position))},$ctor1:function(source,length){if(this.$initialize(),System.IO.Stream.ctor.call(this),source.Position.add(length).gt(source.Length)){this.baseStream=null;this.streamStart=System.Int64(-1);this.streamLength=System.Int64(-1);throw new System.ArgumentOutOfRangeException;}this.baseStream=source;this.streamStart=source.Position;this.streamLength=length},$ctor2:function(source,offset,length){if(this.$initialize(),System.IO.Stream.ctor.call(this),offset.add(length).gt(source.Length)){this.baseStream=null;this.streamStart=System.Int64(-1);this.streamLength=System.Int64(-1);throw new System.ArgumentOutOfRangeException;}source.Position=offset;this.baseStream=source;this.streamStart=source.Position;this.streamLength=length}},methods:{Flush:function(){},Read:function(array,offset,count){return this.baseStream.Position.gte(this.streamStart.add(this.streamLength))?count=0:this.baseStream.Position.add(System.Int64(count)).gt(this.streamStart.add(this.streamLength))&&(count=System.Int64.clip32(this.streamStart.add(this.streamLength).sub(this.baseStream.Position))),this.baseStream.Read(array,offset,count)},ReadByte:function(){return this.baseStream.Position.gte(this.streamStart.add(this.streamLength))?-1:this.baseStream.ReadByte()},Seek:function(offset,origin){switch(origin){case System.IO.SeekOrigin.Begin:if(offset.lt(System.Int64(0))||offset.gt(this.streamLength))throw new System.ArgumentException("offset");return this.baseStream.Seek(this.streamStart.add(offset),System.IO.SeekOrigin.Begin);case System.IO.SeekOrigin.Current:if(this.baseStream.Position.add(offset).lt(this.streamStart)||this.baseStream.Position.add(offset).gt(this.streamStart.add(this.streamLength)))throw new System.ArgumentException("offset");return this.baseStream.Seek(offset,System.IO.SeekOrigin.Current);case System.IO.SeekOrigin.End:if(offset.lt(this.streamLength.neg())||offset.gt(System.Int64(0)))throw new System.ArgumentException("offset");return this.baseStream.Seek(this.streamStart.add(this.streamLength).add(offset),System.IO.SeekOrigin.Begin)}return this.baseStream.Position.sub(this.streamStart)},SetLength:function(){throw new System.NotSupportedException;},Write:function(){throw new System.NotSupportedException;},WriteByte:function(){throw new System.NotSupportedException;},Dispose$1:function(disposing){this.disposed||(System.IO.Stream.prototype.Dispose$1.call(this,disposing),this.baseStream=null,this.streamStart=System.Int64(-1),this.streamLength=System.Int64(-1),this.disposed=!0)}}});Bridge.define("YataOnline.BinaryMath",{statics:{methods:{IsPowerOfTwo:function(x){return(x&(x-1|0))==0},FastMod:function(n,m){return n&(m-1|0)},DivideByPowerOf2:function(x,n){return(x+(x>>31&((1<<n)+-1|0))|0)>>n},Log2:function(v){var r=(65535-v|0)>>31&16,shift;return v=v>>r,shift=(255-v|0)>>31&8,v=v>>shift,r=r|shift,shift=(15-v|0)>>31&4,v=v>>shift,r=r|shift,shift=(3-v|0)>>31&2,v=v>>shift,r=r|shift,r|v>>1}}}});Bridge.define("YataOnline.Exten",{statics:{methods:{ToU32:function(b){return System.BitConverter.toInt32(b,0)>>>0},isPower2:function(x){return x!==0&&(x&(x-1|0))==0},SetPixel:function(img,x,y,R,G,B,A){var index=Bridge.Int.mul(Bridge.Int.umul(y,img.width)+x>>>0|0,4);img.data[Bridge.identity(index,index=index+1|0)]=R&255;img.data[Bridge.identity(index,index=index+1|0)]=G&255;img.data[Bridge.identity(index,index=index+1|0)]=B&255;img.data[index]=A&255},GetPixel:function(img,x,y){var c=new YataOnline.ImageTool.Color,index=Bridge.Int.mul(Bridge.Int.umul(y,img.width)+x>>>0|0,4);return c.R=img.data[Bridge.identity(index,index=index+1|0)],c.G=img.data[Bridge.identity(index,index=index+1|0)],c.B=img.data[Bridge.identity(index,index=index+1|0)],c.A=img.data[index],c.$clone()},ToDataUrl:function(img){var tmp=document.createElement("canvas");return tmp.getContext("2d").putImageData(img,0,0),tmp.toDataURL()},FastMod:function(num,num2){return YataOnline.BinaryMath.FastMod(num|0,num2)>>>0},FastDiv:function(num,num2){return YataOnline.BinaryMath.DivideByPowerOf2(num|0,num2)>>>0}}}});Bridge.define("YataOnline.ImageTool",{statics:{fields:{ImageTypesByID:null},ctors:{init:function(){var $t,$t1;this.ImageTypesByID=System.Array.init([($t=new YataOnline.ImageTool.ImageType,$t.e=YataOnline.ImageTool.Encoding.RGB565,$t.s=($t1=new YataOnline.ImageTool.Size,$t1.x=512,$t1.y=256,$t1),$t.ActualSize=($t1=new YataOnline.ImageTool.Size,$t1.x=410,$t1.y=240,$t1),$t),($t=new YataOnline.ImageTool.ImageType,$t.e=YataOnline.ImageTool.Encoding.RGB565,$t.s=($t1=new YataOnline.ImageTool.Size,$t1.x=1024,$t1.y=256,$t1),$t.ActualSize=($t1=new YataOnline.ImageTool.Size,$t1.x=1008,$t1.y=240,$t1),$t),($t=new YataOnline.ImageTool.ImageType,$t.e=YataOnline.ImageTool.Encoding.RGB565,$t.s=($t1=new YataOnline.ImageTool.Size,$t1.x=512,$t1.y=256,$t1),$t.ActualSize=($t1=new YataOnline.ImageTool.Size,$t1.x=320,$t1.y=240,$t1),$t),($t=new YataOnline.ImageTool.ImageType,$t.e=YataOnline.ImageTool.Encoding.RGB565,$t.s=($t1=new YataOnline.ImageTool.Size,$t1.x=1024,$t1.y=256,$t1),$t.ActualSize=($t1=new YataOnline.ImageTool.Size,$t1.x=960,$t1.y=240,$t1),$t),($t=new YataOnline.ImageTool.ImageType,$t.e=YataOnline.ImageTool.Encoding.RGB565,$t.s=($t1=new YataOnline.ImageTool.Size,$t1.x=1024,$t1.y=256,$t1),$t.ActualSize=($t1=new YataOnline.ImageTool.Size,$t1.x=1008,$t1.y=240,$t1),$t),($t=new YataOnline.ImageTool.ImageType,$t.e=YataOnline.ImageTool.Encoding.A8,$t.s=($t1=new YataOnline.ImageTool.Size,$t1.x=64,$t1.y=64,$t1),$t.ActualSize=($t1=new YataOnline.ImageTool.Size,$t1.x=64,$t1.y=64,$t1),$t),($t=new YataOnline.ImageTool.ImageType,$t.e=YataOnline.ImageTool.Encoding.A8,$t.s=($t1=new YataOnline.ImageTool.Size,$t1.x=64,$t1.y=64,$t1),$t.ActualSize=($t1=new YataOnline.ImageTool.Size,$t1.x=64,$t1.y=64,$t1),$t),($t=new YataOnline.ImageTool.ImageType,$t.e=YataOnline.ImageTool.Encoding.BGR888,$t.s=($t1=new YataOnline.ImageTool.Size,$t1.x=128,$t1.y=64,$t1),$t.ActualSize=($t1=new YataOnline.ImageTool.Size,$t1.x=74,$t1.y=64,$t1),$t),($t=new YataOnline.ImageTool.ImageType,$t.e=YataOnline.ImageTool.Encoding.BGR888,$t.s=($t1=new YataOnline.ImageTool.Size,$t1.x=128,$t1.y=64,$t1),$t.ActualSize=($t1=new YataOnline.ImageTool.Size,$t1.x=82,$t1.y=64,$t1),$t),($t=new YataOnline.ImageTool.ImageType,$t.e=YataOnline.ImageTool.Encoding.BGR888,$t.s=($t1=new YataOnline.ImageTool.Size,$t1.x=64,$t1.y=128,$t1),$t.ActualSize=($t1=new YataOnline.ImageTool.Size,$t1.x=36,$t1.y=64,$t1),$t),($t=new YataOnline.ImageTool.ImageType,$t.e=YataOnline.ImageTool.Encoding.BGR888,$t.s=($t1=new YataOnline.ImageTool.Size,$t1.x=32,$t1.y=64,$t1),$t.ActualSize=($t1=new YataOnline.ImageTool.Size,$t1.x=25,$t1.y=50,$t1),$t)],YataOnline.ImageTool.ImageType)}},methods:{WhiteImage:function(ID){for(var img=new ImageData(YataOnline.ImageTool.ImageTypesByID[System.Array.index(ID,YataOnline.ImageTool.ImageTypesByID)].s.x>>>0,YataOnline.ImageTool.ImageTypesByID[System.Array.index(ID,YataOnline.ImageTool.ImageTypesByID)].s.y>>>0),i=0;i<img.data.length;i=i+1|0)img.data[i]=255;return img},getImage$1:function(bin,ID){var data=bin.ReadBytes(YataOnline.ImageTool.ImageTypesByID[System.Array.index(ID,YataOnline.ImageTool.ImageTypesByID)].length);return YataOnline.ImageTool.getImage(data,ID)},getImage:function(data,ID){var t=YataOnline.ImageTool.ImageTypesByID[System.Array.index(ID,YataOnline.ImageTool.ImageTypesByID)].$clone(),Image=new ImageData(t.s.x>>>0,t.s.y>>>0),x={v:0},y={v:0},p=t.s.x>>3,plog,dec_br,red,blue,green,i,pix,tile,i1,tile1,i2,tile2,col;if(p===0&&(p=1),!YataOnline.BinaryMath.IsPowerOfTwo(p))throw new System.Exception("NOT POWER OF TWO");if(plog=YataOnline.BinaryMath.Log2(p),dec_br=new System.IO.BinaryReader.ctor(new System.IO.MemoryStream.$ctor1(data)),t.e===YataOnline.ImageTool.Encoding.RGB565)for(i=0;dec_br.BaseStream.Position.lt(dec_br.BaseStream.Length);)pix=dec_br.ReadUInt16(),YataOnline.ImageTool.d2xy(YataOnline.Exten.FastMod(i,64),x,y),tile=i>>>6,x.v=x.v+Bridge.Int.umul(YataOnline.Exten.FastMod(tile,p),8)>>>0,y.v=y.v+Bridge.Int.umul(YataOnline.Exten.FastDiv(tile,plog),8)>>>0,red=Bridge.Int.mul((pix>>>11&31)>>>0&255,8),green=Bridge.Int.mul((pix>>>5&63)>>>0&255,4),blue=Bridge.Int.mul((pix&31)>>>0&255,8),YataOnline.Exten.SetPixel(Image,x.v,y.v,red,green,blue,255),i=i+1>>>0;else if(t.e===YataOnline.ImageTool.Encoding.BGR888)for(i1=0;dec_br.BaseStream.Position.lt(dec_br.BaseStream.Length);)YataOnline.ImageTool.d2xy(YataOnline.Exten.FastMod(i1,64),x,y),tile1=i1>>>6,x.v=x.v+Bridge.Int.umul(YataOnline.Exten.FastMod(tile1,p),8)>>>0,y.v=y.v+Bridge.Int.umul(YataOnline.Exten.FastDiv(tile1,plog),8)>>>0,blue=dec_br.ReadByte(),green=dec_br.ReadByte(),red=dec_br.ReadByte(),YataOnline.Exten.SetPixel(Image,x.v,y.v,red,green,blue,255),i1=i1+1>>>0;else if(t.e===YataOnline.ImageTool.Encoding.A8)for(i2=0;dec_br.BaseStream.Position.lt(dec_br.BaseStream.Length);)YataOnline.ImageTool.d2xy(YataOnline.Exten.FastMod(i2,64),x,y),tile2=i2>>>6,x.v=x.v+Bridge.Int.umul(YataOnline.Exten.FastMod(tile2,p),8)>>>0,y.v=y.v+Bridge.Int.umul(YataOnline.Exten.FastDiv(tile2,plog),8)>>>0,col=dec_br.ReadByte(),YataOnline.Exten.SetPixel(Image,x.v,y.v,col,col,col,255),i2=i2+1>>>0;return Image},bitmapToRawImg:function(img,ID){var t=YataOnline.ImageTool.ImageTypesByID[System.Array.index(ID,YataOnline.ImageTool.ImageTypesByID)].$clone(),w=img.width|0,h=img.height|0,array=new(System.Collections.Generic.List$1(System.Byte).$ctor2)(Bridge.Int.mul(Bridge.Int.mul(w,h),t.e)),x={v:0},y={v:0},c=new YataOnline.ImageTool.Color,p=YataOnline.ImageTool.gcm(w,8)>>3,plog,i,tile,val;if(p===0&&(p=1),!YataOnline.BinaryMath.IsPowerOfTwo(p))throw new System.Exception("NOT POWER OF TWO");for(plog=YataOnline.BinaryMath.Log2(p),i=0;System.Int64(i).lt(System.Int64(Bridge.Int.mul(w,h)));i=i+1>>>0)YataOnline.ImageTool.d2xy(YataOnline.Exten.FastMod(i,64),x,y),tile=i>>>6,x.v=x.v+Bridge.Int.umul(YataOnline.Exten.FastMod(tile,p),8)>>>0,y.v=y.v+Bridge.Int.umul(YataOnline.Exten.FastDiv(tile,plog),8)>>>0,c=YataOnline.Exten.GetPixel(img,x.v,y.v),t.e===YataOnline.ImageTool.Encoding.RGB565?(val=(c.R>>3&31)>>>0<<11>>>0,val=val+((c.G>>2&63)<<5>>>0)>>>0,val=val+((c.B>>3&31)>>>0)>>>0,array.add((val&255)>>>0&255),array.add((val>>>8&255)>>>0&255)):t.e===YataOnline.ImageTool.Encoding.BGR888?array.addRange(System.Array.init([c.B,c.G,c.R],System.Byte)):t.e===YataOnline.ImageTool.Encoding.A8&&array.add(c.R);return array.toArray()},gcm:function(n,m){return Bridge.Int.mul(Bridge.Int.div((n+m|0)-1|0,m)|0,m)},nlpo2:function(x){return x=x-1|0,x=x|x>>1,x=x|x>>2,x=x|x>>4,x=x|x>>8,x=x|x>>16,x+1|0},xy2d:function(x,y){return x=(x&65535)>>>0,y=(y&65535)>>>0,x=(x|x<<8>>>0)>>>0,y=(y|y<<8>>>0)>>>0,x=(x&16711935)>>>0,y=(y&16711935)>>>0,x=(x|x<<4>>>0)>>>0,y=(y|y<<4>>>0)>>>0,x=(x&252645135)>>>0,y=(y&252645135)>>>0,x=(x|x<<2>>>0)>>>0,y=(y|y<<2>>>0)>>>0,x=(x&858993459)>>>0,y=(y&858993459)>>>0,x=(x|x<<1>>>0)>>>0,y=(y|y<<1>>>0)>>>0,x=(x&1431655765)>>>0,y=(y&1431655765)>>>0,(x|y<<1>>>0)>>>0},d2xy:function(d,x,y){x.v=d;y.v=x.v>>>1;x.v=(x.v&1431655765)>>>0;y.v=(y.v&1431655765)>>>0;x.v=(x.v|x.v>>>1)>>>0;y.v=(y.v|y.v>>>1)>>>0;x.v=(x.v&858993459)>>>0;y.v=(y.v&858993459)>>>0;x.v=(x.v|x.v>>>2)>>>0;y.v=(y.v|y.v>>>2)>>>0;x.v=(x.v&252645135)>>>0;y.v=(y.v&252645135)>>>0;x.v=(x.v|x.v>>>4)>>>0;y.v=(y.v|y.v>>>4)>>>0;x.v=(x.v&16711935)>>>0;y.v=(y.v&16711935)>>>0;x.v=(x.v|x.v>>>8)>>>0;y.v=(y.v|y.v>>>8)>>>0;x.v=(x.v&65535)>>>0;y.v=(y.v&65535)>>>0}}}});Bridge.define("YataOnline.ImageTool.Color",{$kind:"struct",statics:{methods:{getDefaultValue:function(){return new YataOnline.ImageTool.Color}}},fields:{A:0,R:0,G:0,B:0},ctors:{ctor:function(){this.$initialize()}},methods:{getHashCode:function(){return Bridge.addHash([1869377461,this.A,this.R,this.G,this.B])},equals:function(o){return Bridge.is(o,YataOnline.ImageTool.Color)?Bridge.equals(this.A,o.A)&&Bridge.equals(this.R,o.R)&&Bridge.equals(this.G,o.G)&&Bridge.equals(this.B,o.B):!1},$clone:function(to){var s=to||new YataOnline.ImageTool.Color;return s.A=this.A,s.R=this.R,s.G=this.G,s.B=this.B,s}}});Bridge.define("YataOnline.ImageTool.Encoding",{$kind:"enum",statics:{fields:{A8:1,RGB565:2,BGR888:3}}});Bridge.define("YataOnline.ImageTool.ImageType",{$kind:"struct",statics:{methods:{getDefaultValue:function(){return new YataOnline.ImageTool.ImageType}}},fields:{e:0,s:null,ActualSize:null},props:{length:{get:function(){return Bridge.Int.mul(Bridge.Int.mul(this.s.x,this.s.y),this.e)}}},ctors:{init:function(){this.s=new YataOnline.ImageTool.Size;this.ActualSize=new YataOnline.ImageTool.Size},ctor:function(){this.$initialize()}},methods:{getHashCode:function(){return Bridge.addHash([3621437971,this.e,this.s,this.ActualSize])},equals:function(o){return Bridge.is(o,YataOnline.ImageTool.ImageType)?Bridge.equals(this.e,o.e)&&Bridge.equals(this.s,o.s)&&Bridge.equals(this.ActualSize,o.ActualSize):!1},$clone:function(to){var s=to||new YataOnline.ImageTool.ImageType;return s.e=this.e,s.s=this.s.$clone(),s.ActualSize=this.ActualSize.$clone(),s}}});Bridge.define("YataOnline.ImageTool.Size",{$kind:"struct",statics:{methods:{getDefaultValue:function(){return new YataOnline.ImageTool.Size}}},fields:{x:0,y:0},ctors:{ctor:function(){this.$initialize()}},methods:{getHashCode:function(){return Bridge.addHash([1702521171,this.x,this.y])},equals:function(o){return Bridge.is(o,YataOnline.ImageTool.Size)?Bridge.equals(this.x,o.x)&&Bridge.equals(this.y,o.y):!1},$clone:function(to){var s=to||new YataOnline.ImageTool.Size;return s.x=this.x,s.y=this.y,s}}});Bridge.define("YataOnline.MainClass",{statics:{fields:{t:null,ImagesDiv:null,loader:null,LoaderText:null,TopFrameType:null,BotFrameType:null,AppVersion:0,loadingFaces:null,SenderID:null},ctors:{init:function(){this.AppVersion=1.2;this.loadingFaces=System.Array.init(["(ﾉ≧∀≦)ﾉ・‥…━━━★","o͡͡͡╮༼ ಠДಠ ༽╭o͡͡͡━☆ﾟ.*･｡ﾟ","༼∩✿ل͜✿༽⊃━☆ﾟ. * ･ ｡ﾟ","༼(∩ ͡°╭͜ʖ╮͡ ͡°)༽⊃━☆ﾟ. * ･ ｡ﾟ","ᕦ( ✿ ⊙ ͜ʖ ⊙ ✿ )━☆ﾟ.*･｡ﾟ","(∩｀-´)⊃━☆ﾟ.*･｡ﾟ","༼∩☉ل͜☉༽⊃━☆ﾟ. * ･ ｡ﾟ","╰( ͡° ͜ʖ ͡° )つ──☆*:・ﾟ","(∩ ͡° ͜ʖ ͡°)⊃━☆ﾟ","੭•̀ω•́)੭̸*✩⁺˚","(੭ˊ͈ ꒵ˋ͈)੭̸*✧⁺˚","✩°｡⋆⸜(ू｡•ω•｡)","ヽ༼ຈل͜ຈ༽⊃─☆*:・ﾟ","╰(•̀ 3 •́)━☆ﾟ.*･｡ﾟ","(*’▽’)ノ＾—==ΞΞΞ☆","(੭•̀ω•́)੭̸*✩⁺˚","(っ・ω・）っ≡≡≡≡≡≡☆",". * ･ ｡ﾟ☆━੧༼ •́ ヮ •̀ ༽୨","༼∩ •́ ヮ •̀ ༽⊃━☆ﾟ. * ･ ｡ﾟ","(⊃｡•́‿•̀｡)⊃━☆ﾟ.*･｡ﾟ","★≡≡＼（`△´＼）","( ◔ ౪◔)⊃━☆ﾟ.*・","彡ﾟ◉ω◉ )つー☆*","(☆_・)・‥…━━━★","(つ◕౪◕)つ━☆ﾟ.*･｡ﾟ","(つ˵•́ω•̀˵)つ━☆ﾟ.*･｡ﾟ҉̛༽̨҉҉ﾉ","✩°｡⋆⸜(ू˙꒳​˙ )","╰( ⁰ ਊ ⁰ )━☆ﾟ.*･｡ﾟ"],System.String);this.SenderID=""}},methods:{DoActionWithloading:function(action){YataOnline.MainClass.LoaderText.textContent=YataOnline.MainClass.loadingFaces[System.Array.index((new System.Random.ctor).next$2(0,YataOnline.MainClass.loadingFaces.length),YataOnline.MainClass.loadingFaces)];YataOnline.MainClass.loader.style.display="";window.setTimeout(function(){action();YataOnline.MainClass.loader.style.display="none"},100)},OnLoaded:function(){document.getElementById("pVersion").textContent="Ver "+(System.Single.format(YataOnline.MainClass.AppVersion,"N1")||"");document.getElementById("javascriptWarn").hidden=!0;YataOnline.MainClass.ImagesDiv=document.getElementById("PlaceImages");YataOnline.MainClass.loader=document.getElementById("loaderDiv");YataOnline.MainClass.LoaderText=document.getElementById("LoadingText");YataOnline.MainClass.TopFrameType=document.getElementById("Top-screen-TYP");YataOnline.MainClass.BotFrameType=document.getElementById("Bottom-screen-TYP");YataOnline.MainClass.TopFrameType.onchange=Bridge.fn.combine(YataOnline.MainClass.TopFrameType.onchange,YataOnline.MainClass.ListBoxChanged);YataOnline.MainClass.BotFrameType.onchange=Bridge.fn.combine(YataOnline.MainClass.BotFrameType.onchange,YataOnline.MainClass.ListBoxChanged);window.onresize=Bridge.fn.combine(window.onresize,YataOnline.MainClass.OnResized);var useragent=window.navigator.userAgent.toLowerCase();System.String.contains(useragent,"edge")?document.getElementById("EdgeWarn").hidden=!1:(System.String.contains(useragent,"msie")||System.String.contains(useragent,"trident"))&&(document.getElementById("interwebExplorerWarn").hidden=!1)},OnResized:function(){YataOnline.MainClass.t!=null&&(YataOnline.MainClass.HtmlCanvasFitSize(document.getElementById(YataOnline.Theme.Name_TopScr),YataOnline.MainClass.t.TopImageType.s.$clone()),YataOnline.MainClass.HtmlCanvasFitSize(document.getElementById(YataOnline.Theme.Name_BotScr),YataOnline.MainClass.t.BotImageType.s.$clone()))},HtmlCanvasFitSize:function(em,OriginalSize){var width,ratio,height;em!=null&&(width=window.innerWidth-60|0,width>=OriginalSize.x?(em.style.width=OriginalSize.x+"px",em.style.height=OriginalSize.y+"px"):(ratio=OriginalSize.y/OriginalSize.x,height=Bridge.Int.clip32(ratio*width),em.style.width=width+"px",em.style.height=height+"px"))},OpenThemeBtn:function(){document.getElementById("openThemeUploader").click()},ListBoxChanged:function(arg){YataOnline.MainClass.SenderID=arg.currentTarget.id;YataOnline.MainClass.SenderID=YataOnline.MainClass.SenderID.substr(0,YataOnline.MainClass.SenderID.length-4|0);var tex=YataOnline.MainClass.t.GetTexture(YataOnline.MainClass.SenderID);YataOnline.MainClass.t.TopScreenFrameType=YataOnline.MainClass.TopFrameType.selectedIndex>>>0;YataOnline.MainClass.t.BotScreenFrameType=YataOnline.MainClass.BotFrameType.selectedIndex>>>0;YataOnline.MainClass.t.TopScreenFrameType===2&&(YataOnline.MainClass.t.TopScreenFrameType=1);!Bridge.referenceEquals(YataOnline.MainClass.SenderID,YataOnline.Theme.Name_TopScr)||System.Int64(tex.tex.width).equals(System.Int64(YataOnline.MainClass.t.TopImageType.s.x))&&System.Int64(tex.tex.height).equals(System.Int64(YataOnline.MainClass.t.TopImageType.s.y))?!Bridge.referenceEquals(YataOnline.MainClass.SenderID,YataOnline.Theme.Name_BotScr)||System.Int64(tex.tex.width).equals(System.Int64(YataOnline.MainClass.t.BotImageType.s.x))&&System.Int64(tex.tex.height).equals(System.Int64(YataOnline.MainClass.t.BotImageType.s.y))||(tex.tex=YataOnline.ImageTool.WhiteImage(YataOnline.MainClass.t.BotScreenImageID),YataOnline.MainClass.UpdateShownImg(YataOnline.MainClass.t.BotImageType.$clone(),YataOnline.MainClass.SenderID,tex.tex),document.getElementById((YataOnline.MainClass.SenderID||"")+"-LBL").textContent=(System.String.replaceAll(YataOnline.MainClass.SenderID,String.fromCharCode(45),String.fromCharCode(32))||"")+" ("+(YataOnline.MainClass.t.BotImageType.s.x.toString()||"")+"x"+(YataOnline.MainClass.t.BotImageType.s.y.toString()||"")+")"):(tex.tex=YataOnline.ImageTool.WhiteImage(YataOnline.MainClass.t.TopScreenImageID),YataOnline.MainClass.UpdateShownImg(YataOnline.MainClass.t.TopImageType.$clone(),YataOnline.MainClass.SenderID,tex.tex),document.getElementById((YataOnline.MainClass.SenderID||"")+"-LBL").textContent=(System.String.replaceAll(YataOnline.MainClass.SenderID,String.fromCharCode(45),String.fromCharCode(32))||"")+" ("+(YataOnline.MainClass.t.TopImageType.s.x.toString()||"")+"x"+(YataOnline.MainClass.t.TopImageType.s.y.toString()||"")+")");YataOnline.MainClass.OnResized(null)},LoadFile:function(arr){YataOnline.MainClass.LoadThemeFromByteArr(System.Linq.Enumerable.from(arr).toArray())},LoadThemeFromByteArr:function(data){YataOnline.MainClass.DoActionWithloading(function(){var c=new PuyoTools.Modules.Compression.Lz11Compression,inData=new System.IO.MemoryStream.$ctor1(data),decData=new System.IO.MemoryStream.ctor;if(c.Decompress$4(inData,decData),decData.Position=System.Int64(0),YataOnline.MainClass.t=YataOnline.Theme.ReadTheme(decData),!(YataOnline.MainClass.t.TopScreenDrawType===3&&YataOnline.MainClass.t.BotScreenDrawType===3)){window.alert("Theme draw type not supported");YataOnline.MainClass.t=null;return}YataOnline.MainClass.UpdateThemeDIV()})},ExampleTheme:function(){YataOnline.MainClass.DoActionWithloading(function(){YataOnline.MainClass.t=YataOnline.Theme.EmptyTheme();YataOnline.MainClass.UpdateThemeDIV()})},UpdateThemeDIV:function(){var $t,$t1,c,tex;$t=Bridge.getEnumerator(YataOnline.MainClass.ImagesDiv.childNodes);try{while($t.moveNext())c=$t.Current,YataOnline.MainClass.ImagesDiv.removeChild(c)}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$dispose()}YataOnline.MainClass.TopFrameType.selectedIndex=YataOnline.MainClass.t.TopScreenFrameType|0;YataOnline.MainClass.BotFrameType.selectedIndex=YataOnline.MainClass.t.BotScreenFrameType|0;document.getElementById("EnableBGMchb").checked=YataOnline.MainClass.t.BGM;document.getElementById("LoadFile").remove();$t1=Bridge.getEnumerator(YataOnline.MainClass.t.textures);try{while($t1.moveNext())tex=$t1.Current,YataOnline.MainClass.AddToPage(tex.tex,tex.name)}finally{Bridge.is($t1,System.IDisposable)&&$t1.System$IDisposable$dispose()}document.getElementById("EditFile").hidden=!1},LoadImage:function(arr){if(document.getElementById("ImageUpload").value="",arr.length<6){window.alert("file too small");return}if(!(arr[0]===137&&arr[1]===80&&arr[2]===78&&arr[3]===71&&arr[4]===13||arr[0]===255&&arr[1]===216&&arr[2]===255&&(arr[3]===224||arr[3]===225))){window.alert("unsupported file");return}YataOnline.MainClass.DoActionWithloading(function(){var tmpImg=document.createElement("canvas"),img;if(arr[0]===137)PNG.load(arr,tmpImg);else if(arr[0]===255){var decarr=new Uint8Array(0),wid=0,hei=0,decoded=JpegDecode(arr,!0);wid=decoded.width;hei=decoded.height;decarr=decoded.data;tmpImg.width=wid;tmpImg.height=hei;img=new ImageData(new Uint8ClampedArray(decarr),wid>>>0,hei>>>0);tmpImg.getContext("2d").putImageData(img,0,0)}YataOnline.MainClass.ApplyImage(tmpImg)})},ApplyImage:function(tmpImg){var imgType=YataOnline.ImageTool.ImageTypesByID[System.Array.index(YataOnline.MainClass.t.NameToImageID(YataOnline.MainClass.SenderID),YataOnline.ImageTool.ImageTypesByID)].$clone(),FinalCanvas=document.createElement("canvas"),context,context1,context2,img;FinalCanvas.width=imgType.s.x;FinalCanvas.height=imgType.s.y;tmpImg==null?(YataOnline.MainClass.t.GetTexture(YataOnline.MainClass.SenderID).tex=null,context=FinalCanvas.getContext("2d"),context.fillRect(0,0,imgType.s.x,imgType.s.y)):tmpImg.width===imgType.ActualSize.x&&tmpImg.height===imgType.ActualSize.y?(context1=FinalCanvas.getContext("2d"),context1.fillRect(0,0,imgType.s.x,imgType.s.y),context1.drawImage(tmpImg,0,0)):tmpImg.width===imgType.s.x&&tmpImg.height===imgType.s.y?FinalCanvas=tmpImg:(context2=FinalCanvas.getContext("2d"),context2.fillRect(0,0,imgType.s.x,imgType.s.y),context2.drawImage(tmpImg,0,0,imgType.ActualSize.x,imgType.ActualSize.y));img=FinalCanvas.getContext("2d").getImageData(0,0,imgType.s.x,imgType.s.y);YataOnline.MainClass.t.GetTexture(YataOnline.MainClass.SenderID).tex=tmpImg==null?null:img;YataOnline.MainClass.UpdateShownImg(imgType.$clone(),YataOnline.MainClass.SenderID,img)},UpdateShownImg:function(imgType,ID,img){var ShownImg=document.getElementById(ID);ShownImg.width=imgType.s.x;ShownImg.height=imgType.s.y;ShownImg.getContext("2d").putImageData(img,0,0)},AddToPage:function(tex,Id){var div=document.createElement("div"),c,imgType;div.className="col";div.style.padding="5px";c=document.createElement("canvas");c.id=Id;c.className="CustomCanvas";c.style.backgroundColor="#FAFAFA";imgType=YataOnline.ImageTool.ImageTypesByID[System.Array.index(YataOnline.MainClass.t.NameToImageID(Id),YataOnline.ImageTool.ImageTypesByID)].$clone();c.height=imgType.s.y;c.width=imgType.s.x;c.onclick=YataOnline.MainClass.canvasClick;c.style.margin="auto";c.style.border="black 3px solid";div.appendChild(YataOnline.MainClass.MakeLabel(Id,(imgType.s.x.toString()||"")+"x"+(imgType.s.y.toString()||"")));Bridge.referenceEquals(Id,YataOnline.Theme.Name_TopScr)||Bridge.referenceEquals(Id,YataOnline.Theme.Name_BotScr)?YataOnline.MainClass.HtmlCanvasFitSize(c,imgType.s.$clone()):div.appendChild(YataOnline.MainClass.MakeCheckBox(Id,tex!=null));div.appendChild(c);YataOnline.MainClass.ImagesDiv.appendChild(div);tex!=null&&c.getContext("2d").putImageData(tex,0,0)},MakeLabel:function(ID,size){var _a=document.createElement("label"),_div;return _a.textContent=(System.String.replaceAll(ID,String.fromCharCode(45),String.fromCharCode(32))||"")+" ("+(size||"")+")",_a.id=(ID||"")+"-LBL",_div=document.createElement("div"),_div.appendChild(_a),_div},MakeCheckBox:function(id,check){var container=document.createElement("div"),chb,lab;return container.className="form-check",chb=document.createElement("input"),chb.type="checkbox",chb.checked=check,chb.id=(id||"")+"-CHB",chb.onchange=YataOnline.MainClass.chb_changed,chb.className="form-check-input",container.appendChild(chb),lab=document.createElement("label"),lab.className="form-check-label",lab.textContent="Enabled",container.appendChild(lab),container},chb_changed:function(arg){YataOnline.MainClass.SenderID=arg.currentTarget.id;YataOnline.MainClass.SenderID=YataOnline.MainClass.SenderID.substr(0,YataOnline.MainClass.SenderID.length-4|0);YataOnline.MainClass.ApplyImage(null)},canvasClick:function(arg){if(!Bridge.referenceEquals(arg.target.id,YataOnline.Theme.Name_TopScr)&&!Bridge.referenceEquals(arg.target.id,YataOnline.Theme.Name_BotScr)){var chb=document.getElementById((arg.target.id||"")+"-CHB");if(!chb.checked){window.alert("This image is not enabled");return}}YataOnline.MainClass.SenderID=arg.target.id;document.getElementById("ImageUpload").click()},SaveTheme:function(){if(window.confirm("Save theme ?\r\nThis might take up to a minute, don't close this page")){var bgm=document.getElementById("EnableBGMchb");YataOnline.MainClass.t.BGM=bgm.checked;YataOnline.MainClass.t.TopScreenFrameType=YataOnline.MainClass.TopFrameType.selectedIndex>>>0;YataOnline.MainClass.t.BotScreenFrameType=YataOnline.MainClass.BotFrameType.selectedIndex>>>0;YataOnline.MainClass.DoActionWithloading(function(){var themedata=YataOnline.MainClass.t.MakeTheme(),c=new PuyoTools.Modules.Compression.Lz11Compression,inData=new System.IO.MemoryStream.$ctor1(themedata),compData=new System.IO.MemoryStream.ctor,dwn;document.getElementById("Fastbuild").checked?c.ArchiveNoCompression(inData,compData):c.Compress$4(inData,compData);dwn=new Uint8Array(compData.ToArray());downloadBlob(dwn,"Body_LZ.bin","application/octet-stream")})}},GoBack:function(){window.confirm("Go back ?")&&document.location.reload()}}}});Bridge.define("YataOnline.Theme",{statics:{fields:{Name_TopScr:null,Name_BotScr:null,Name_Folder:null,Name_FolderOpn:null,Name_IcnSmall:null,Name_IcnBig:null},ctors:{init:function(){this.Name_TopScr="Top-screen";this.Name_BotScr="Bottom-screen";this.Name_Folder="Folder";this.Name_FolderOpn="Open-folder";this.Name_IcnSmall="Small-icon";this.Name_IcnBig="Big-icon"}},methods:{EmptyTheme:function(){var t=new YataOnline.Theme;return t.TopScreenDrawType=3,t.TopScreenFrameType=1,t.BotScreenDrawType=3,t.BotScreenFrameType=1,t.textures[System.Array.index(0,t.textures)].tex=YataOnline.ImageTool.WhiteImage(t.TopScreenImageID),t.textures[System.Array.index(1,t.textures)].tex=YataOnline.ImageTool.WhiteImage(t.BotScreenImageID),t},ReadTheme:function(s){var bin=new System.IO.BinaryReader.ctor(s),t,offset,offset1,offs1,offs2,offs11,offs21;return bin.BaseStream.Position=System.Int64(5),t=new YataOnline.Theme,t.BGM=bin.ReadByte()!==0,bin.BaseStream.Position=System.Int64(12),t.TopScreenDrawType=bin.ReadUInt32(),t.TopScreenFrameType=bin.ReadUInt32(),t.TopScreenDrawType===3&&(bin.BaseStream.Position=System.Int64(24),offset=bin.ReadUInt32(),bin.BaseStream.Position=System.Int64(offset),t.GetTexture(YataOnline.Theme.Name_TopScr).tex=YataOnline.ImageTool.getImage$1(bin,t.TopScreenImageID)),bin.BaseStream.Position=System.Int64(32),t.BotScreenDrawType=bin.ReadUInt32(),t.BotScreenFrameType=bin.ReadUInt32(),t.BotScreenDrawType===3&&(bin.BaseStream.Position=System.Int64(40),offset1=bin.ReadUInt32(),bin.BaseStream.Position=System.Int64(offset1),t.GetTexture(YataOnline.Theme.Name_BotScr).tex=YataOnline.ImageTool.getImage$1(bin,t.BotScreenImageID)),bin.BaseStream.Position=System.Int64(60),bin.ReadUInt32()!==0&&(offs1=bin.ReadUInt32(),offs2=bin.ReadUInt32(),bin.BaseStream.Position=System.Int64(offs1),t.GetTexture(YataOnline.Theme.Name_Folder).tex=YataOnline.ImageTool.getImage$1(bin,7),bin.BaseStream.Position=System.Int64(offs2),t.GetTexture(YataOnline.Theme.Name_FolderOpn).tex=YataOnline.ImageTool.getImage$1(bin,8)),bin.BaseStream.Position=System.Int64(80),bin.ReadUInt32()!==0&&(offs11=bin.ReadUInt32(),offs21=bin.ReadUInt32(),bin.BaseStream.Position=System.Int64(offs11),t.GetTexture(YataOnline.Theme.Name_IcnBig).tex=YataOnline.ImageTool.getImage$1(bin,9),bin.BaseStream.Position=System.Int64(offs21),t.GetTexture(YataOnline.Theme.Name_IcnSmall).tex=YataOnline.ImageTool.getImage$1(bin,10)),t}}},fields:{BGM:!1,textures:null,TopScreenDrawType:0,TopScreenFrameType:0,BotScreenDrawType:0,BotScreenFrameType:0},props:{TopImageType:{get:function(){return YataOnline.ImageTool.ImageTypesByID[System.Array.index(this.TopScreenImageID,YataOnline.ImageTool.ImageTypesByID)].$clone()}},BotImageType:{get:function(){return YataOnline.ImageTool.ImageTypesByID[System.Array.index(this.BotScreenImageID,YataOnline.ImageTool.ImageTypesByID)].$clone()}},TopScreenImageID:{get:function(){return this.TopScreenFrameType===0||this.TopScreenFrameType===3?1:0}},BotScreenImageID:{get:function(){return this.BotScreenFrameType===0||this.BotScreenFrameType===3?4:this.BotScreenFrameType===2||this.BotScreenFrameType===4?3:2}}},ctors:{init:function(){this.BGM=!1;this.textures=System.Array.init([new YataOnline.Theme.Texture(YataOnline.Theme.Name_TopScr),new YataOnline.Theme.Texture(YataOnline.Theme.Name_BotScr),new YataOnline.Theme.Texture(YataOnline.Theme.Name_Folder),new YataOnline.Theme.Texture(YataOnline.Theme.Name_FolderOpn),new YataOnline.Theme.Texture(YataOnline.Theme.Name_IcnBig),new YataOnline.Theme.Texture(YataOnline.Theme.Name_IcnSmall)],YataOnline.Theme.Texture)}},methods:{MakeTheme:function(){var mem=new System.IO.MemoryStream.ctor,bin=new System.IO.BinaryWriter.$ctor1(mem),writeTex78,writeTex910,i,offset,NextOffset;for(bin.Write$10(1),bin.Write$1(0),bin.Write$1((this.BGM?1:0)&255),bin.Write$10(0),bin.Write$9(0),bin.Write$16(this.TopScreenDrawType),bin.Write$16(this.TopScreenFrameType),bin.Write$10(0),bin.Write$10(0),bin.Write$10(0),bin.Write$16(this.BotScreenDrawType),bin.Write$16(this.BotScreenFrameType),bin.Write$10(0),bin.Write$10(0),bin.Write$10(0),bin.Write$10(0),bin.Write$10(0),writeTex78=this.textures[System.Array.index(2,this.textures)].tex!=null&&this.textures[System.Array.index(3,this.textures)].tex!=null,bin.Write$1((writeTex78?1:0)&255),bin.Write$10(0),bin.Write$10(0),bin.Write$10(0),bin.Write$10(0),writeTex910=this.textures[System.Array.index(4,this.textures)].tex!=null&&this.textures[System.Array.index(5,this.textures)].tex!=null,bin.Write$1((writeTex910?1:0)&255),bin.Write$10(0),bin.Write$10(0),i=0;i<27;i=i+1|0)bin.Write$10(0);for(this.textures[System.Array.index(0,this.textures)].tex==null&&(this.textures[System.Array.index(0,this.textures)].tex=YataOnline.ImageTool.WhiteImage(this.TopScreenImageID)),offset=System.Int64.clipu32(bin.BaseStream.Position),bin.Write$2(YataOnline.ImageTool.bitmapToRawImg(this.textures[System.Array.index(0,this.textures)].tex,this.TopScreenImageID)),NextOffset=System.Int64.clipu32(bin.BaseStream.Position),bin.BaseStream.Position=System.Int64(24),bin.Write$16(offset),bin.BaseStream.Position=System.Int64(NextOffset),this.textures[System.Array.index(1,this.textures)].tex==null&&(this.textures[System.Array.index(1,this.textures)].tex=YataOnline.ImageTool.WhiteImage(this.BotScreenImageID)),offset=System.Int64.clipu32(bin.BaseStream.Position),bin.Write$2(YataOnline.ImageTool.bitmapToRawImg(this.textures[System.Array.index(1,this.textures)].tex,this.BotScreenImageID)),NextOffset=System.Int64.clipu32(bin.BaseStream.Position),bin.BaseStream.Position=System.Int64(40),bin.Write$16(offset),bin.BaseStream.Position=System.Int64(NextOffset),writeTex78&&(offset=System.Int64.clipu32(bin.BaseStream.Position),bin.Write$2(YataOnline.ImageTool.bitmapToRawImg(this.textures[System.Array.index(2,this.textures)].tex,7)),NextOffset=System.Int64.clipu32(bin.BaseStream.Position),bin.BaseStream.Position=System.Int64(64),bin.Write$16(offset),bin.BaseStream.Position=System.Int64(NextOffset),offset=System.Int64.clipu32(bin.BaseStream.Position),bin.Write$2(YataOnline.ImageTool.bitmapToRawImg(this.textures[System.Array.index(3,this.textures)].tex,8)),NextOffset=System.Int64.clipu32(bin.BaseStream.Position),bin.BaseStream.Position=System.Int64(68),bin.Write$16(offset),bin.BaseStream.Position=System.Int64(NextOffset)),writeTex910&&(offset=System.Int64.clipu32(bin.BaseStream.Position),bin.Write$2(YataOnline.ImageTool.bitmapToRawImg(this.textures[System.Array.index(4,this.textures)].tex,9)),NextOffset=System.Int64.clipu32(bin.BaseStream.Position),bin.BaseStream.Position=System.Int64(84),bin.Write$16(offset),bin.BaseStream.Position=System.Int64(NextOffset),offset=System.Int64.clipu32(bin.BaseStream.Position),bin.Write$2(YataOnline.ImageTool.bitmapToRawImg(this.textures[System.Array.index(5,this.textures)].tex,10)),NextOffset=System.Int64.clipu32(bin.BaseStream.Position),bin.BaseStream.Position=System.Int64(88),bin.Write$16(offset),bin.BaseStream.Position=System.Int64(NextOffset));bin.BaseStream.Position.mod(System.Int64(8)).ne(System.Int64(0));)bin.Write$1(0);return mem.ToArray()},GetTexture:function(name){var $t,t;$t=Bridge.getEnumerator(this.textures);try{while($t.moveNext())if(t=$t.Current,Bridge.referenceEquals(t.name,name))return t}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$dispose()}return null},NameToImageID:function(name){switch(name){case YataOnline.Theme.Name_TopScr:return this.TopScreenImageID;case YataOnline.Theme.Name_BotScr:return this.BotScreenImageID;case YataOnline.Theme.Name_Folder:return 7;case YataOnline.Theme.Name_FolderOpn:return 8;case YataOnline.Theme.Name_IcnBig:return 9;case YataOnline.Theme.Name_IcnSmall:return 10}return-1}}});Bridge.define("YataOnline.Theme.Texture",{fields:{tex:null,name:null},ctors:{ctor:function(_name){this.$initialize();this.name=_name;this.tex=null}}});Bridge.define("PuyoTools.Modules.ModuleBase",{inherits:[PuyoTools.Modules.IModule],fields:{SourcePath:null,DestinationPath:null},ctors:{init:function(){this.SourcePath="";this.DestinationPath=""}},methods:{Is$4:function(){return!0},Is$3:function(source,fname){return this.Is$2(source,System.Int64.clip32(source.Length.sub(source.Position)),fname)},Is$1:function(source,fname){return this.Is(source,0,source.length,fname)},Is:function(source,sourceIndex,length,fname){var buffer=new System.IO.MemoryStream.ctor;try{return buffer.Write(source,sourceIndex,length),buffer.Position=System.Int64(0),this.Is$2(buffer,length,fname)}finally{Bridge.hasValue(buffer)&&buffer.System$IDisposable$dispose()}}}});Bridge.define("PuyoTools.Modules.Compression.CompressionBase",{inherits:[PuyoTools.Modules.ModuleBase],methods:{Decompress$5:function(source,destination,length){this.Decompress$4(new PuyoTools.Modules.StreamView.$ctor1(source,System.Int64(length)),destination)},Decompress$6:function(){throw new System.Exception("Not implemented");},Decompress$2:function(source,destination){this.Decompress$3(source,0,destination,source.length)},Decompress$3:function(source,offset,destination,length){var destinationStream=new System.IO.MemoryStream.ctor,sourceStream=new System.IO.MemoryStream.ctor;try{sourceStream.Write(source,offset,length);sourceStream.Position=System.Int64(0);this.Decompress$5(sourceStream,destinationStream,length);destination.v=destinationStream.ToArray()}finally{Bridge.hasValue(sourceStream)&&sourceStream.System$IDisposable$dispose()}},Decompress$1:function(source){var destination=new System.IO.MemoryStream.ctor;return this.Decompress$4(source,destination),destination.Position=System.Int64(0),destination},Decompress:function(source){var destination={};return this.Decompress$2(source,destination),destination.v},Compress$5:function(source,destination,length){this.Compress$4(new PuyoTools.Modules.StreamView.$ctor1(source,System.Int64(length)),destination)},Compress$6:function(){throw new System.Exception("Not implemented");},Compress$2:function(source,destination){this.Compress$3(source,0,destination,source.length)},Compress$3:function(source,offset,destination,length){var destinationStream=new System.IO.MemoryStream.ctor,sourceStream=new System.IO.MemoryStream.ctor;try{sourceStream.Write(source,offset,length);sourceStream.Position=System.Int64(0);this.Compress$5(sourceStream,destinationStream,length);destination.v=destinationStream.ToArray()}finally{Bridge.hasValue(sourceStream)&&sourceStream.System$IDisposable$dispose()}},Compress$1:function(source){var destination=new System.IO.MemoryStream.ctor;return this.Compress$4(source,destination),destination.Position=System.Int64(0),destination},Compress:function(source){var destination={};return this.Compress$2(source,destination),destination.v}}});Bridge.define("PuyoTools.Modules.Compression.Lz11Compression",{inherits:[PuyoTools.Modules.Compression.CompressionBase],props:{Name:{get:function(){return"LZ11"}},CanWrite:{get:function(){return!0}}},methods:{Decompress$4:function(source,destination){var sourcePointer=4,destinationPointer=0,bufferPointer=0,sourceLength=System.Int64.clip32(source.Length.sub(source.Position)),destinationLength=PuyoTools.Modules.PTStream.ReadInt32(source)>>8,buffer,flag,i,value,matchDistance,matchLength,b1,b2,b3,b4,j;for(destinationLength===0&&(destinationLength=PuyoTools.Modules.PTStream.ReadInt32(source),sourcePointer=sourcePointer+4|0),buffer=System.Array.init(4096,0,System.Byte);sourcePointer<sourceLength;)for(flag=PuyoTools.Modules.PTStream.ReadByte(source),sourcePointer=sourcePointer+1|0,i=0;i<8;i=i+1|0){if((flag&128)==0)value=PuyoTools.Modules.PTStream.ReadByte(source),sourcePointer=sourcePointer+1|0,destination.WriteByte(value),destinationPointer=destinationPointer+1|0,buffer[System.Array.index(bufferPointer,buffer)]=value,bufferPointer=(bufferPointer+1|0)&4095;else{b1=PuyoTools.Modules.PTStream.ReadByte(source);b2=PuyoTools.Modules.PTStream.ReadByte(source);sourcePointer=sourcePointer+2|0;switch(b1>>4){case 0:b3=PuyoTools.Modules.PTStream.ReadByte(source);sourcePointer=sourcePointer+1|0;matchDistance=((b2&15)<<8|b3)+1|0;matchLength=((b1&15)<<4|b2>>4)+17|0;break;case 1:b3=PuyoTools.Modules.PTStream.ReadByte(source);b4=PuyoTools.Modules.PTStream.ReadByte(source);sourcePointer=sourcePointer+2|0;matchDistance=((b3&15)<<8|b4)+1|0;matchLength=((b1&15)<<12|b2<<4|b3>>4)+273|0;break;default:matchDistance=((b1&15)<<8|b2)+1|0;matchLength=(b1>>4)+1|0}for(j=0;j<matchLength;j=j+1|0)destination.WriteByte(buffer[System.Array.index((bufferPointer-matchDistance|0)&4095,buffer)]),destinationPointer=destinationPointer+1|0,buffer[System.Array.index(bufferPointer,buffer)]=buffer[System.Array.index((bufferPointer-matchDistance|0)&4095,buffer)],bufferPointer=(bufferPointer+1|0)&4095}if(sourcePointer>=sourceLength)break;if(destinationPointer>destinationLength)throw new System.Exception("Too much data written to the destination.");flag=flag<<1&255}},Compress$4:function(source,destination){this.Compress$7(source,destination,!1)},Compress$7:function(source,destination,fast){var sourceLength=System.Int64.clip32(source.Length.sub(source.Position)),sourceArray=System.Array.init(sourceLength,0,System.Byte),buffer,flag,i,match,value;source.Read(sourceArray,0,sourceLength);var sourcePointer=0,destinationPointer=4,dictionary=new PuyoTools.Modules.Compression.LzWindowDictionary;for(fast?(dictionary.SetWindowSize(3),dictionary.SetMaxMatchAmount(3)):(dictionary.SetWindowSize(16),dictionary.SetMaxMatchAmount(16)),sourceLength<=16777215?PuyoTools.Modules.PTStream.WriteInt32(destination,17|sourceLength<<8):(destination.WriteByte(17),PuyoTools.Modules.PTStream.WriteInt32(destination,sourceLength),destinationPointer=destinationPointer+4|0);sourcePointer<sourceLength;){buffer=new System.IO.MemoryStream.ctor;try{for(flag=0,i=7;i>=0;i=i-1|0)if(match=dictionary.Search(sourceArray,sourcePointer>>>0,sourceLength>>>0),match[System.Array.index(1,match)]>0?(flag=(flag|1<<i&255)&255,match[System.Array.index(1,match)]<=16?(buffer.WriteByte((((match[System.Array.index(1,match)]-1|0)&15)<<4|((match[System.Array.index(0,match)]-1|0)&4095)>>8)&255),buffer.WriteByte((match[System.Array.index(0,match)]-1|0)&255)):match[System.Array.index(1,match)]<=272?(buffer.WriteByte(((match[System.Array.index(1,match)]-17|0)&255)>>4&255),buffer.WriteByte((((match[System.Array.index(1,match)]-17|0)&15)<<4|((match[System.Array.index(0,match)]-1|0)&4095)>>8)&255),buffer.WriteByte((match[System.Array.index(0,match)]-1|0)&255)):(buffer.WriteByte((16|((match[System.Array.index(1,match)]-273|0)&65535)>>12)&255),buffer.WriteByte(((match[System.Array.index(1,match)]-273|0)&4095)>>4&255),buffer.WriteByte((((match[System.Array.index(1,match)]-273|0)&15)<<4|((match[System.Array.index(0,match)]-1|0)&4095)>>8)&255),buffer.WriteByte((match[System.Array.index(0,match)]-1|0)&255)),dictionary.AddEntryRange(sourceArray,sourcePointer,match[System.Array.index(1,match)]),dictionary.SlideWindow(match[System.Array.index(1,match)]),sourcePointer=sourcePointer+match[System.Array.index(1,match)]|0):(buffer.WriteByte(sourceArray[System.Array.index(sourcePointer,sourceArray)]),dictionary.AddEntry(sourceArray,sourcePointer),dictionary.SlideWindow(1),sourcePointer=sourcePointer+1|0),sourcePointer>=sourceLength)break;for(destination.WriteByte(flag),buffer.Position=System.Int64(0);buffer.Position.lt(buffer.Length);)value=PuyoTools.Modules.PTStream.ReadByte(buffer),destination.WriteByte(value);destinationPointer=destinationPointer+(System.Int64.clip32(buffer.Length)+1|0)|0}finally{Bridge.hasValue(buffer)&&buffer.System$IDisposable$dispose()}}},ArchiveNoCompression:function(source,destination){var bin,buf;for(source.Position=System.Int64(0),destination.Position=System.Int64(0),bin=new System.IO.BinaryWriter.$ctor1(destination),bin.Write$10(17|System.Int64.clip32(source.Length)<<8),buf=System.Array.init(8,0,System.Byte);source.Read(buf,0,8)>0;)bin.Write$1(0),bin.Write$2(buf)},Is$2:function(source,length){return length>4&&PuyoTools.Modules.PTStream.Contains(source,System.Int64(0),System.Array.init([17],System.Byte))}}})});